<%- include ('partials/header.ejs') %>
<link
    rel="stylesheet"
    href="https://multivendor1.clientweb.xyz/public/admin/css/select2.min.css"
/>
<link
    rel="stylesheet"
    type="text/css"
    href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css"
/>
<style>
    #attributeDropdownContainer,
    #attValDrpdwnContainer,
    #variantTable {
        display: none;
    }
    .select2.select2-container.select2-container--default {
        width: 100% !important;
    }
</style>
<!-- Begin page -->
<div id="layout-wrapper">
    <!-- Start right Content here -->
    <!-- ============================================================== -->
    <div class="main-content">
        <div class="page-content">
            <div class="container-fluid">
                <!-- start page title -->
                <div class="row">
                    <div class="col-12">
                        <div
                            class="page-title-box d-sm-flex align-items-center justify-content-between"
                        >
                            <h4 class="mb-sm-0">Add Product</h4>

                            <div class="page-title-right">
                                <ol class="breadcrumb m-0">
                                    <li class="breadcrumb-item">
                                        <a href="javascript: void(0);">
                                            Product</a
                                        >
                                    </li>
                                    <li class="breadcrumb-item active">
                                        Add Product
                                    </li>
                                </ol>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- end page title -->

                <form id="addProductForm">
                    <div class="row">
                        <div class="col-lg-12">
                            <div
                                class="d-flex align-items-center flex-wrap gap-2 mb-4"
                            >
                                <ul
                                    class="nav nav-pills arrow-navtabs nav-secondary gap-2 flex-grow-1 order-2 order-lg-1"
                                    role="tablist"
                                >
                                    <!-- Product Information Tab1  -->
                                    <li class="nav-item" role="presentation">
                                        <a
                                            class="nav-link active"
                                            data-bs-toggle="tab"
                                            href="#productinfo"
                                            role="tab"
                                            aria-selected="false"
                                            tabindex="-1"
                                        >
                                            Product Information
                                        </a>
                                    </li>

                                    <!-- Images & Videos Tab2  -->
                                    <li class="nav-item" role="presentation">
                                        <a
                                            class="nav-link"
                                            data-bs-toggle="tab"
                                            href="#proimages"
                                            role="tab"
                                            aria-selected="false"
                                            tabindex="-1"
                                        >
                                            Images & Videos
                                        </a>
                                    </li>

                                    <!-- Product Price & Stock3  -->
                                    <li class="nav-item" role="presentation">
                                        <a
                                            class="nav-link"
                                            data-bs-toggle="tab"
                                            href="#productstock"
                                            role="tab"
                                            aria-selected="false"
                                            tabindex="-1"
                                        >
                                            Product Price & Stock
                                        </a>
                                    </li>

                                    <!-- Description & Specification Tab  -->
                                    <li class="nav-item" role="presentation">
                                        <a
                                            class="nav-link"
                                            data-bs-toggle="tab"
                                            href="#prdescriptions"
                                            role="tab"
                                            aria-selected="true"
                                        >
                                            Description & Specification
                                        </a>
                                    </li>

                                    <li class="nav-item" role="presentation">
                                        <a
                                            class="nav-link"
                                            data-bs-toggle="tab"
                                            href="#others"
                                            role="tab"
                                            aria-selected="false"
                                            tabindex="-1"
                                        >
                                            Others
                                        </a>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <a
                                            class="nav-link"
                                            data-bs-toggle="tab"
                                            href="#seo"
                                            role="tab"
                                            aria-selected="false"
                                            tabindex="-1"
                                        >
                                            SEO
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            <div class="card">
                                <div class="tab-content">
                                    <!-- Product Information Tab -->
                                    <div
                                        class="tab-pane active"
                                        id="productinfo"
                                        role="tabpanel"
                                    >
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-xxl-12">
                                                    <div class="row">
                                                        <div
                                                            class="col-lg-6 mb-3"
                                                        >
                                                            <label
                                                                for="productTitle"
                                                                class="form-label"
                                                                >Product Name
                                                                <span
                                                                    class="text-danger"
                                                                    >*</span
                                                                ></label
                                                            >
                                                            <input
                                                                type="text"
                                                                class="form-control"
                                                                id="product_name"
                                                                name="product_name"
                                                                placeholder="Enter product name"
                                                            />
                                                        </div>
                                                        <div class="col-lg-6">
                                                            <div class="mb-3">
                                                                <label
                                                                    for="productBrand"
                                                                    class="form-label"
                                                                    >Brand</label
                                                                >
                                                                <select
                                                                    class="form-control"
                                                                    data-choices
                                                                    name="brand_id"
                                                                    id="brand_id"
                                                                >
                                                                    <option
                                                                        value=""
                                                                        disabled
                                                                        selected
                                                                    >
                                                                        Select
                                                                        Brand
                                                                    </option>
                                                                    <%brand.forEach(function(element){
                                                                    %>
                                                                    <option
                                                                        value="<%= element._id %>"
                                                                    >
                                                                        <%=
                                                                        element.name%>
                                                                    </option>
                                                                    <% }); %>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-lg-6">
                                                            <div class="mb-3">
                                                                <label
                                                                    for="productUnit"
                                                                    class="form-label"
                                                                    >Unit</label
                                                                >
                                                                <input
                                                                    type="text"
                                                                    class="form-control"
                                                                    id="productUnit"
                                                                    name="unit"
                                                                    placeholder="Enter product unit"
                                                                />
                                                            </div>
                                                        </div>
                                                        <div class="col-lg-6">
                                                            <label
                                                                for="productStyle"
                                                                class="form-label"
                                                                >Min. Order
                                                                Quantity
                                                                <span
                                                                    class="text-danger"
                                                                    >*</span
                                                                >
                                                            </label>
                                                            <input
                                                                type="number"
                                                                class="form-control"
                                                                id="min_order_quantity"
                                                                name="min_order_quantity"
                                                                min="1"
                                                                value="1"
                                                                placeholder="Enter min order quantity"
                                                            />
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-lg-6">
                                                            <div class="mb-3">
                                                                <label
                                                                    for="productUnit"
                                                                    class="form-label"
                                                                    >Tags
                                                                </label>
                                                                <input
                                                                    type="text"
                                                                    class="form-control"
                                                                    id="tags"
                                                                    name="tags"
                                                                    placeholder="Write tags"
                                                                />
                                                            </div>
                                                        </div>
                                                        <div class="col-lg-6">
                                                            <label
                                                                for="productStyle"
                                                                class="form-label"
                                                                >Slug
                                                                <span
                                                                    class="text-danger"
                                                                    >*</span
                                                                >
                                                            </label>
                                                            <input
                                                                type="text"
                                                                class="form-control"
                                                                id="slug"
                                                                name="slug"
                                                                placeholder="Enter slug"
                                                            />
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-lg-6">
                                                            <!-- status   -->
                                                            <div class="mb-3">
                                                                <label
                                                                    for="choices-publish-status-input"
                                                                    class="form-label"
                                                                    >Status</label
                                                                >
                                                                <select
                                                                    class="form-control"
                                                                    id="status_id"
                                                                    name="status_id"
                                                                >
                                                                    <option
                                                                        value=""
                                                                        disabled
                                                                        selected
                                                                    >
                                                                        Select
                                                                        Status
                                                                    </option>
                                                                    <%status.forEach(function(element){
                                                                    %>
                                                                    <option
                                                                        value="<%= element._id %>"
                                                                    >
                                                                        <%=
                                                                        element.name%>
                                                                    </option>
                                                                    <% }); %>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Product Images Tab -->
                                    <div
                                        class="tab-pane"
                                        id="proimages"
                                        role="tabpanel"
                                    >
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-lg-12">
                                                    <div class="card">
                                                        <div
                                                            class="page-title-box d-sm-flex align-items-center justify-content-between"
                                                        >
                                                            <h4 class="mb-sm-0">
                                                                Product Images
                                                            </h4>
                                                        </div>
                                                        <div class="mb-3">
                                                            <label
                                                                class="form-label"
                                                                >Thumbnail
                                                                <span
                                                                    class="text-danger"
                                                                    >*</span
                                                                ></label
                                                            >
                                                            <input
                                                                type="file"
                                                                class="form-control"
                                                                id="thumbnail"
                                                                name="thumbnail"
                                                                placeholder="Upload thumbnail"
                                                            />
                                                        </div>

                                                        <div class="mb-3">
                                                            <label
                                                                class="form-label"
                                                                >Gallery Images
                                                                <span
                                                                    class="text-danger"
                                                                    >*</span
                                                                ></label
                                                            >
                                                            <input
                                                                type="file"
                                                                class="form-control"
                                                                id="gallery_image"
                                                                name="gallery_image"
                                                                multiple
                                                                placeholder="Upload gallery image"
                                                            />
                                                        </div>
                                                    </div>
                                                    <div class="card">
                                                        <div
                                                            class="card-header extra-padding"
                                                        >
                                                            <h4>
                                                                Product Video
                                                            </h4>
                                                        </div>
                                                        <div class="card-body">
                                                            <div class="row">
                                                                <div
                                                                    class="col-lg-9"
                                                                >
                                                                    <label
                                                                        for="productStyle"
                                                                        class="form-label"
                                                                        >Video
                                                                        URL
                                                                    </label>
                                                                    <input
                                                                        type="text"
                                                                        class="form-control"
                                                                        id="video_url"
                                                                        name="video_url"
                                                                        placeholder="Enter video url"
                                                                    />
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!--end col-->
                                            </div>
                                            <!--end row-->
                                        </div>
                                    </div>

                                    <!-- Product Price & Stock Tab -->
                                    <div
                                        class="tab-pane"
                                        id="productstock"
                                        role="tabpanel"
                                    >
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-lg-12">
                                                    <div class="card">
                                                        <div class="row gy-3">
                                                            <div
                                                                class="col-lg-9"
                                                            >
                                                                <div>
                                                                    <label
                                                                        for="manufacturer-name-input"
                                                                        class="form-label"
                                                                        >Unit
                                                                        Price
                                                                        <span
                                                                            class="text-danger"
                                                                            >*</span
                                                                        >
                                                                    </label>
                                                                    <input
                                                                        type="number"
                                                                        class="form-control"
                                                                        id="unit_price"
                                                                        name="unit_price"
                                                                        step="any"
                                                                        min="0"
                                                                        placeholder="Enter unit price"
                                                                    />
                                                                </div>
                                                            </div>
                                                            <!--end col-->
                                                            <div
                                                                class="col-lg-6"
                                                            >
                                                                <div>
                                                                    <label
                                                                        class="form-label"
                                                                        for="manufacturer-brand-input"
                                                                        >Special
                                                                        Discount
                                                                        Type</label
                                                                    >
                                                                    <select
                                                                        class="form-control"
                                                                        id="special_discount_type"
                                                                        name="special_discount_type"
                                                                    >
                                                                        <option
                                                                            value=""
                                                                            disabled
                                                                            selected
                                                                        >
                                                                            Select
                                                                            Discount
                                                                            Type
                                                                        </option>
                                                                        <option
                                                                            value="flat"
                                                                        >
                                                                            Flat
                                                                        </option>
                                                                        <option
                                                                            value="percentage"
                                                                        >
                                                                            Percentage
                                                                        </option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                            <div
                                                                class="col-lg-6"
                                                            >
                                                                <div>
                                                                    <label
                                                                        for="productStocks"
                                                                        class="form-label"
                                                                    >
                                                                        Special
                                                                        Discount
                                                                    </label>
                                                                    <input
                                                                        type="number"
                                                                        class="form-control"
                                                                        id="special_discount"
                                                                        name="special_discount"
                                                                        placeholder="Enter discount"
                                                                    />
                                                                </div>
                                                            </div>
                                                            <div
                                                                class="col-lg-12"
                                                            >
                                                                <div
                                                                    class="form-group"
                                                                >
                                                                    <label
                                                                        for="special_discount_period"
                                                                        class="form-label"
                                                                        >Special
                                                                        Discount
                                                                        Period</label
                                                                    >
                                                                    <input
                                                                        type="text"
                                                                        name="special_discount_period"
                                                                        id="special_discount_period"
                                                                        class="form-control daterange-cus"
                                                                        placeholder="Select Date Range"
                                                                    />
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-lg-12">
                                                    <div class="card">
                                                        <div
                                                            class="page-title-box d-sm-flex align-items-center justify-content-between"
                                                        >
                                                            <h4 class="mb-sm-0">
                                                                Product Stock
                                                            </h4>
                                                            <div
                                                                class="col-lg-6"
                                                            >
                                                                <div
                                                                    class="form-check form-switch"
                                                                >
                                                                    <input
                                                                        class="form-check-input"
                                                                        type="checkbox"
                                                                        role="switch"
                                                                        id="variant"
                                                                        name="variant"
                                                                        onchange="toggleVariant()"
                                                                    />
                                                                    <label
                                                                        class="form-check-label"
                                                                        for="variant"
                                                                        >Has
                                                                        Variant</label
                                                                    >
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row gy-3">
                                                            <div
                                                                class="col-lg-6"
                                                            >
                                                                <div>
                                                                    <label
                                                                        for="manufacturer-name-input"
                                                                        class="form-label"
                                                                        >Minimum
                                                                        Stock
                                                                        Warning
                                                                    </label>
                                                                    <input
                                                                        type="number"
                                                                        class="form-control"
                                                                        id="min_stock_quantity"
                                                                        name="min_stock_quantity"
                                                                        min="0"
                                                                        placeholder="Enter minimum stock"
                                                                    />
                                                                </div>
                                                            </div>
                                                            <!--end col-->
                                                            <div
                                                                class="col-lg-6"
                                                            >
                                                                <div>
                                                                    <label
                                                                        class="form-label"
                                                                        for="manufacturer-brand-input"
                                                                        >Stock
                                                                        Visibility</label
                                                                    >
                                                                    <select
                                                                        class="form-control"
                                                                        id="stock_visibility"
                                                                        name="stock_visibility"
                                                                    >
                                                                        <option
                                                                            value=""
                                                                            disabled
                                                                            selected
                                                                        >
                                                                            Select
                                                                            Stock
                                                                            Visibility
                                                                        </option>
                                                                        <option
                                                                            value="hide_stock"
                                                                        >
                                                                            Hide
                                                                            Stock
                                                                        </option>
                                                                        <option
                                                                            value="visible_with_quantity"
                                                                        >
                                                                            Visible
                                                                            with
                                                                            quantity
                                                                        </option>
                                                                        <option
                                                                            value="visible_with_text"
                                                                        >
                                                                            Visible
                                                                            with
                                                                            text
                                                                        </option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                            <!--end col-->
                                                            <div
                                                                class="col-lg-6"
                                                                id="skuContainer"
                                                            >
                                                                <div>
                                                                    <label
                                                                        for="sku"
                                                                        class="form-label"
                                                                        >SKU
                                                                        <span
                                                                            class="text-danger"
                                                                            >*</span
                                                                        ></label
                                                                    >
                                                                    <input
                                                                        type="number"
                                                                        class="form-control"
                                                                        id="sku"
                                                                        name="sku"
                                                                        placeholder="Enter SKU"
                                                                    />
                                                                </div>
                                                            </div>
                                                            <div
                                                                id="attributeDropdownContainer"
                                                            >
                                                                <div
                                                                    class="form-group"
                                                                >
                                                                    <label
                                                                        class="form-label"
                                                                        >Colors</label
                                                                    >
                                                                    <div
                                                                        class="row gutters-xs"
                                                                    ></div>
                                                                </div>
                                                                <div
                                                                    class="form-group row"
                                                                >
                                                                    <div
                                                                        class="col-md-3"
                                                                    >
                                                                        <input
                                                                            type="text"
                                                                            class="form-control"
                                                                            value="Attribute Sets"
                                                                            disabled=""
                                                                        />
                                                                    </div>
                                                                    <div
                                                                        class="col-md-9"
                                                                    >
                                                                        <select
                                                                            class="form-control select2 attribute-sets select2-hidden-accessible"
                                                                            id="attribute_sets_id"
                                                                            name="attribute_sets_id"
                                                                            multiple=""
                                                                            tabindex="-1"
                                                                            aria-hidden="true"
                                                                            onchange="showAttributeValues()"
                                                                        >
                                                                            <%attributes.forEach(function(element){
                                                                            %>
                                                                            <option
                                                                                value="<%= element._id %>"
                                                                            >
                                                                                <%=
                                                                                element.title%>
                                                                            </option>
                                                                            <%
                                                                            });
                                                                            %>
                                                                        </select>
                                                                        <p
                                                                            class="invalid-feedback text-info"
                                                                        >
                                                                            N.B:
                                                                            Select
                                                                            Attribute
                                                                            sets
                                                                            of
                                                                            this
                                                                            product
                                                                            to
                                                                            add
                                                                            attribute
                                                                            values
                                                                        </p>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div
                                                                class="attribute-values"
                                                                id="attValDrpdwnContainer"
                                                            >
                                                                <div
                                                                    class="form-group row"
                                                                >
                                                                    <div
                                                                        class="col-md-3"
                                                                    >
                                                                        <input
                                                                            type="text"
                                                                            class="form-control"
                                                                            id="attribute_value_input"
                                                                            value=""
                                                                            disabled=""
                                                                        />
                                                                    </div>
                                                                    <div
                                                                        class="col-md-9"
                                                                    >
                                                                        <select
                                                                            class="form-control select2 variant select2-hidden-accessible"
                                                                            name="attribute_value_id"
                                                                            id="attribute_value_id"
                                                                            multiple=""
                                                                            tabindex="-1"
                                                                            aria-hidden="true"
                                                                            onchange="showTable()"
                                                                        >
                                                                            <%attributeValues.forEach(function(element){
                                                                            %>
                                                                            <option
                                                                                value="<%= element._id %>"
                                                                            >
                                                                                <%=
                                                                                element.value%>
                                                                            </option>
                                                                            <%
                                                                            });
                                                                            %>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <!-- Product Stock Table  -->
                                                        <div
                                                            class="form-group row variant-table mt-3"
                                                            id="variantTable"
                                                        >
                                                            <table
                                                                class="table table-striped table-bordered product-variant-table"
                                                            >
                                                                <thead>
                                                                    <tr>
                                                                        <td
                                                                            scope="col"
                                                                        >
                                                                            Variant
                                                                        </td>
                                                                        <td
                                                                            scope="col"
                                                                        >
                                                                            Price
                                                                            *
                                                                        </td>
                                                                        <td
                                                                            scope="col"
                                                                        >
                                                                            SKU
                                                                            *
                                                                        </td>
                                                                        <td
                                                                            scope="col"
                                                                        >
                                                                            Current
                                                                            Stock
                                                                            *
                                                                        </td>
                                                                        <td
                                                                            scope="col"
                                                                        >
                                                                            Image
                                                                        </td>
                                                                        <td>
                                                                            Action
                                                                        </td>
                                                                    </tr>
                                                                </thead>
                                                                <tbody
                                                                    id="variantTableBody"
                                                                >
                                                                    <!-- Rows will be added by JavaScript -->
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                        <!-- Product Stock Table  -->
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Product Description Tab -->
                                    <div
                                        class="tab-pane"
                                        id="prdescriptions"
                                        role="tabpanel"
                                    >
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-lg-12 mb-3">
                                                    <div>
                                                        <label
                                                            class="form-label"
                                                            >Short Description
                                                        </label>
                                                        <textarea
                                                            class="form-control"
                                                            type="text"
                                                            name="short_description"
                                                            id="short_description"
                                                            rows="3"
                                                            placeholder="Enter short description"
                                                        ></textarea>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-lg-12 mb-3">
                                                    <div>
                                                        <label
                                                            class="form-label"
                                                            >Long Description
                                                        </label>
                                                        <textarea
                                                            type="text"
                                                            class="form-control"
                                                            id="long_description"
                                                            name="long_description"
                                                            placeholder="Enter Long Description"
                                                        ></textarea>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-lg-12 mb-3">
                                                    <div>
                                                        <label
                                                            class="form-label"
                                                            >Description Image
                                                        </label>
                                                        <input
                                                            type="file"
                                                            class="form-control"
                                                            id="description_image"
                                                            name="description_image"
                                                            placeholder="Upload description image"
                                                        />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="card-body">
                                            <div
                                                class="page-title-box d-sm-flex align-items-center justify-content-between"
                                            >
                                                <h4 class="mb-sm-0">
                                                    PDF Specification
                                                </h4>
                                            </div>
                                            <div class="row">
                                                <div class="col-lg-12 mb-3">
                                                    <div>
                                                        <label
                                                            class="form-label"
                                                            >PDF Specification
                                                        </label>
                                                        <input
                                                            type="file"
                                                            class="form-control"
                                                            id="pdf"
                                                            name="pdf"
                                                            placeholder="Upload pdf"
                                                        />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Others Tab -->
                                    <div
                                        class="tab-pane"
                                        id="others"
                                        role="tabpanel"
                                    >
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-lg-12">
                                                    <div class="card">
                                                        <div
                                                            class="page-title-box d-sm-flex align-items-center justify-content-between"
                                                        >
                                                            <h4 class="mb-sm-0">
                                                                Statuses
                                                            </h4>
                                                        </div>
                                                        <div
                                                            class="card-body extra-padding"
                                                        >
                                                            <div
                                                                class="form-group row mt-2"
                                                            >
                                                                <label
                                                                    class="col-lg-5 col-from-label"
                                                                    >Featured</label
                                                                >
                                                                <div
                                                                    class="col-lg-7 form-check form-switch"
                                                                >
                                                                    <input
                                                                        type="checkbox"
                                                                        name="is_featured"
                                                                        id="is_featured"
                                                                        class="form-check-input"
                                                                    />
                                                                    <span
                                                                        class="custom-switch-indicator"
                                                                    ></span>
                                                                    <label
                                                                        class="form-check-label"
                                                                        for="variant"
                                                                        >Add to
                                                                        Featured</label
                                                                    >
                                                                </div>
                                                            </div>

                                                            <div
                                                                class="form-group row mt-2"
                                                            >
                                                                <label
                                                                    class="col-lg-5 col-from-label"
                                                                    >Today's
                                                                    Deal</label
                                                                >
                                                                <div
                                                                    class="col-lg-7 form-check form-switch"
                                                                >
                                                                    <input
                                                                        type="checkbox"
                                                                        name="todays_deal"
                                                                        id="todays_deal"
                                                                        class="form-check-input"
                                                                    />
                                                                    <span
                                                                        class="custom-switch-indicator"
                                                                    ></span>
                                                                    <label
                                                                        class="form-check-label"
                                                                        for="variant"
                                                                        >Add to
                                                                        Today's
                                                                        Deal</label
                                                                    >
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!--end col-->
                                            </div>
                                            <!--end row-->
                                        </div>
                                    </div>

                                    <!-- SEO Tab -->
                                    <div
                                        class="tab-pane"
                                        id="seo"
                                        role="tabpanel"
                                    >
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-lg-12">
                                                    <div class="card">
                                                        <div class="row gy-3">
                                                            <div
                                                                class="col-lg-9"
                                                            >
                                                                <div>
                                                                    <label
                                                                        for="product-manufacturer"
                                                                        class="form-label"
                                                                        >Meta
                                                                        Title</label
                                                                    >
                                                                    <input
                                                                        type="text"
                                                                        class="form-control"
                                                                        id="meta_title"
                                                                        name="meta_title"
                                                                        placeholder="Enter Meta Title"
                                                                    />
                                                                </div>
                                                            </div>
                                                            <!--end col-->
                                                            <div
                                                                class="col-lg-12"
                                                            >
                                                                <div>
                                                                    <label
                                                                        class="form-label"
                                                                        for="productPacker"
                                                                        >Meta
                                                                        Description</label
                                                                    >
                                                                    <textarea
                                                                        type="text"
                                                                        class="form-control"
                                                                        id="meta_description"
                                                                        name="meta_description"
                                                                        placeholder="Enter Meta Description"
                                                                    ></textarea>
                                                                </div>
                                                            </div>
                                                            <!--end col-->
                                                            <div
                                                                class="col-lg-9"
                                                            >
                                                                <div>
                                                                    <label
                                                                        for="productimporter"
                                                                        class="form-label"
                                                                        >Meta
                                                                        Keywords</label
                                                                    >
                                                                    <input
                                                                        type="text"
                                                                        class="form-control"
                                                                        id="meta_keywords"
                                                                        name="meta_keywords"
                                                                        placeholder="Enter Meta Keywords"
                                                                    />
                                                                </div>
                                                            </div>

                                                            <div
                                                                class="col-lg-9"
                                                            >
                                                                <div>
                                                                    <label
                                                                        for="productGname"
                                                                        class="form-label"
                                                                        >Meta
                                                                        Image</label
                                                                    >
                                                                    <input
                                                                        type="file"
                                                                        class="form-control"
                                                                        id="meta_image"
                                                                        name="meta_image"
                                                                        placeholder="Upload Meta Image"
                                                                    />
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!--end col-->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="hstack gap-2 justify-content-end mb-3">
                        <button type="submit" class="btn btn-thm">
                            Submit
                        </button>
                    </div>
                </form>
            </div>
            <!-- container-fluid -->
        </div>
        <!-- End Page-content -->
    </div>
    <!-- end main content-->
</div>
<!-- END layout-wrapper -->

<%- include ('partials/footer.ejs') %>
<!-- JAVASCRIPT -->
<script src="/assets/libs/dropzone/dropzone-min.js"></script>
<script src="/assets/libs/%40ckeditor/ckeditor5-build-classic/build/ckeditor.js"></script>
<script src="/assets/js/pages/ecommerce-create-product.init.js"></script>
<script
    type="text/javascript"
    src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"
></script>
<script
    type="text/javascript"
    src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"
></script>
<script src="https://multivendor1.clientweb.xyz/public/admin/js/select2.min.js"></script>
<script type="text/javascript">
    // Select2
    if (jQuery().select2) {
        $(".select2").select2();
    }
</script>

<!-- toggleVariant javascript -->
<script>
    function toggleVariant() {
        const variantCheckbox = document.getElementById("variant");
        const skuContainer = document.getElementById("skuContainer");
        const attributeDropdownContainer = document.getElementById(
            "attributeDropdownContainer"
        );
        const attValDrpdwnContainer = document.getElementById(
            "attValDrpdwnContainer"
        );
        const variantTable = document.getElementById("variantTable");

        if (variantCheckbox.checked) {
            skuContainer.style.display = "none";
            attributeDropdownContainer.style.display = "block";
        } else {
            skuContainer.style.display = "block";
            attributeDropdownContainer.style.display = "none";
            attValDrpdwnContainer.style.display = "none";
            variantTable.style.display = "none";
        }
    }
</script>

<!-- Date Range Picker For Discount period-->
<script>
    $(function () {
        $('input[name="special_discount_period"]').daterangepicker({
            timePicker: true,
            autoUpdateInput: false,
            locale: {
                format: "DD/MM/YYYY hh:mm A",
                cancelLabel: "Clear",
            },
        });
        $('input[name="special_discount_period"]').on(
            "apply.daterangepicker",
            function (ev, picker) {
                $(this).val(
                    picker.startDate.format("DD/MM/YYYY hh:mm A") +
                        " - " +
                        picker.endDate.format("DD/MM/YYYY hh:mm A")
                );
            }
        );

        $('input[name="special_discount_period"]').on(
            "cancel.daterangepicker",
            function (ev, picker) {
                $(this).val("");
            }
        );
    });
</script>

<!--function script showAttributeValues showTable -->
<script>
    function showAttributeValues() {
        const attributeDropdown = document.getElementById("attribute_sets_id");
        const attValDrpdwnContainer = document.getElementById(
            "attValDrpdwnContainer"
        );
        const variantTable = document.getElementById("variantTable");

        attValDrpdwnContainer.innerHTML = "";
        var attributeSets = JSON.parse("<%- JSON.stringify(attributes) %>");
        var selectedAttributeSets = $("#attribute_sets_id").val();

        if (selectedAttributeSets.length > 0) {
            selectedAttributeSets.forEach(function (attributeSetId) {
                var selectedAttributeSet = attributeSets.find(function (
                    element
                ) {
                    return element._id === attributeSetId;
                });
                $.ajax({
                    url: "/admin/product/get-attribute-values",
                    type: "POST",
                    data: JSON.stringify({ attributeSetIds: [attributeSetId] }),
                    contentType: "application/json",
                    success: function (attributeValues) {
                        var attributeValueSelect =
                            document.createElement("select");
                        attributeValueSelect.className =
                            "form-control select2 variant";
                        attributeValueSelect.name = "attribute_value_id";
                        // attributeValueSelect.id = "attribute_value_id_" + attributeSetId;
                        attributeValueSelect.multiple = true;
                        attributeValueSelect.onchange = showTable;

                        attributeValues.forEach(function (element) {
                            var option = document.createElement("option");
                            option.value = element._id;
                            option.textContent = element.value;
                            attributeValueSelect.appendChild(option);
                        });

                        var attributeValueContainer =
                            document.createElement("div");
                        attributeValueContainer.className = "form-group row";

                        var labelCol = document.createElement("div");
                        labelCol.className = "col-md-3 mb-3";

                        var label = document.createElement("input");
                        label.type = "text";
                        label.className = "form-control";
                        label.value = selectedAttributeSet.title;
                        label.disabled = true;

                        labelCol.appendChild(label);

                        var selectCol = document.createElement("div");
                        selectCol.className = "col-md-9";
                        selectCol.appendChild(attributeValueSelect);

                        attributeValueContainer.appendChild(labelCol);
                        attributeValueContainer.appendChild(selectCol);

                        attValDrpdwnContainer.appendChild(
                            attributeValueContainer
                        );

                        $(".select2").select2();
                    },
                    error: function (error) {
                        console.error(
                            "Error fetching attribute value: ",
                            error.message
                        );
                    },
                });
            });
            $("#attValDrpdwnContainer").show();
        } else {
            $("#attValDrpdwnContainer").hide();
            $("#variantTable").hide();
        }
    }

    function showTable() {
        var attributeValues = JSON.parse(
            "<%- JSON.stringify(attributeValues) %>"
        );
        var selectedAttributeValues = [];

        $("#attValDrpdwnContainer select").each(function () {
            var values = $(this).val();
            if (values) {
                selectedAttributeValues =
                    selectedAttributeValues.concat(values);
            }
        });
        var variantTableBody = $("#variantTableBody");
        variantTableBody.empty();

        selectedAttributeValues.forEach(function (attributeValueId) {
            var attributeValue = attributeValues.find(function (element) {
                return element._id === attributeValueId;
            });

            var row = `
            <tr>
                       <td width="18%">
                    
                    <label class="font-normal">${attributeValue.value}</label>
                     </td>
                        <td width="18%">
                            <input type="number" lang="en" name="price" id="price" value="0" min="0" step="any" class="form-control" />
                        </td>
                        <td width="18%">
                            <input type="text" name="sku" id="sku" class="form-control" />
                        </td>
                        <td width="18%">
                            <input type="number" lang="en" name="current_stock" id="current_stock" value="" min="0" step="1" class="form-control" />
                        </td>
                        <td width="22%">
                            <div>
                                <input type="file" name="image" id="image" class="form-control" />
                            </div>
                        </td>
                        <td width="6%">
                            <button type="button" class="btn btn-icon btn-sm btn-danger remove-menu-row" onclick="$(this).closest('tr').remove();">
                                <i class="bx bx-trash"></i>
                            </button>
                        </td>
                    </tr>
            `;

            variantTableBody.append(row);
        }),
            (document.getElementById("variantTable").style.display = "block");
    }
</script>

<!-- Script for addProductForm Ajax -->
<script>
    var addform = $("#addProductForm");
    addform.on("submit", submitFormHandler);

    function submitFormHandler(e) {
        e.preventDefault();

        function getFormData($form) {
            var unindexed_array = $form.serializeArray();
            var indexed_array = {};

            $.map(unindexed_array, function (n, i) {
                indexed_array[n["name"]] = n["value"];
            });

            return indexed_array;
        }

        if ($("#product_name").val() == "") {
            iziToast.warning({
                title: "Warning",
                message: "Product Name is required",
                position: "topRight",
            });
            return;
        }
        if ($("#min_order_quantity").val() == "") {
            iziToast.warning({
                title: "Warning",
                message: "Min Order Quantity is required",
                position: "topRight",
            });
            return;
        }
        if ($("#slug").val() == "") {
            iziToast.warning({
                title: "Warning",
                message: "Slug is required",
                position: "topRight",
            });
            return;
        }
        if ($("#category-field").val() == "") {
            iziToast.warning({
                title: "Warning",
                message: "Category is required",
                position: "topRight",
            });
            return;
        }
        if ($("#thumbnail").val() == "") {
            iziToast.warning({
                title: "Warning",
                message: "Thumbnail is required",
                position: "topRight",
            });
            return;
        }
        if ($("#gallery_image").val() == "") {
            iziToast.warning({
                title: "Warning",
                message: "Gallery Image is required",
                position: "topRight",
            });
            return;
        }
        if ($("#unit_price").val() == "") {
            iziToast.warning({
                title: "Warning",
                message: "Unit Price is required",
                position: "topRight",
            });
            return;
        }

        const variantChecked = document.getElementById("variant").checked;
        var formData;

        if (variantChecked) {
            var attributeValueIds = [];
            var skus = [];
            var currentStocks = [];
            var prices = [];
            var images = [];

            $("#variantTableBody tr").each(function () {
                var attributeValueId = $(this)
                    .find('select[name="attribute_value_id"]')
                    .val();
                var sku = $(this).find('input[name="sku"]').val();
                var currentStock = $(this)
                    .find('input[name="current_stock"]')
                    .val();
                var price = $(this).find('input[name="price"]').val();
                var image = $(this).find('input[name="image"]').val();

                attributeValueIds.push(attributeValueId);
                skus.push(sku);
                currentStocks.push(currentStock);
                prices.push(price);
                images.push(image);
            });

            formData = getFormData($("#addProductForm"));
            formData.attribute_value_id = attributeValueIds.filter(
                (val) => val
            );
            formData.sku = skus.filter((val) => val);
            formData.current_stock = currentStocks.filter((val) => val);
            formData.price = prices.filter((val) => val);
            formData.image = images.filter((val) => val);
        } else {
            var sku = $("#sku").val();
            formData = getFormData($("#addProductForm"));
            formData.sku = sku;
        }

        var currentForm = addform[0];
        var hasImages =
            currentForm.querySelector('input[type="file"]').files.length > 0;
        if (hasImages) {
            formData = new FormData(currentForm);
            console.log(formData);
        } else {
            formData = getFormData(addform);
        }

        $.ajax({
            type: "POST",
            url: "/seller/product/add",
            data: hasImages ? formData : JSON.stringify(formData),
            cache: false,
            contentType: hasImages ? false : "application/json",
            processData: !hasImages,
        })
            .done((res) => {
                if (res.status == 200) {
                    iziToast.success({
                        title: "Success",
                        message: res.message,
                        position: "topRight",
                    });
                } else {
                    iziToast.error({
                        title: "Error",
                        message: res.message,
                        position: "topRight",
                    });
                }
                setTimeout(function () {
                    location.reload();
                }, 1000);
            })
            .fail(function (xhr, status, error) {
                iziToast.error({
                    title: "Error",
                    message: xhr.responseText,
                    position: "topRight",
                });
            });
    }
</script>
